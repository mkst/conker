#include <ultra64.h>

#include "functions.h"
#include "variables.h"

extern u16 D_80085EC0[61];
extern u16 D_80085F3C[64];
extern u16 D_80085FBC[4];

#if 0
u16 D_80085EC0[61] = {
    32768, 32442, 32116, 31789,
    31463, 31136,  30809, 30481,
    30153, 29824,  29495, 29164,
    28833, 28501,  28167, 27832,
    27496, 27159,  26820, 26480,
    26138, 25793,  25447, 25099,
    24749, 24396,  24041, 23683,
    23322, 22958,  22590, 22219,
    21845, 21467,  21084, 20697,
    20305, 19909,  19506, 19098,
    18684, 18263,  17835, 17399,
    16954, 16501,  16037, 15563,
    15077, 14577,  14063, 13532,
    12983, 12413,  11819, 11197,
    10542,  9848,   9105,  8300,
    7414 };

u16 D_80085F3C[64] = {
    7414, 7355, 7296, 7237,
    7176, 7116, 7055, 6993,
    6931, 6868, 6805, 6741,
    6676, 6611, 6546, 6479,
    6412, 6345, 6276, 6207,
    6137, 6067, 5995, 5923,
    5850, 5776, 5701, 5625,
    5548, 5470, 5391, 5310,
    5229, 5146, 5062, 4976,
    4889, 4801, 4711, 4619,
    4525, 4430, 4332, 4232,
    4130, 4025, 3917, 3806,
    3692, 3575, 3453, 3328,
    3197, 3060, 2918, 2768,
    2609, 2441, 2259, 2062,
    1844, 1597, 1304, 922 };

u16 D_80085FBC[4] = { 922, 798, 652, 461 };
#endif

s32 func_150485E0(s32 arg0) {
    s32 index;
    s32 tmp1;
    s32 tmp2;
    u16* array;
    s32 phi_a1;
    s32 phi_v1;

    if (arg0 >= 32736) {
        phi_v1 = 7;
        phi_a1 = 3;
        array = D_80085FBC;
        arg0 -= 32736;
    } else if (arg0 >= 30720) {
        phi_v1 = 31;
        phi_a1 = 5;
        array = D_80085F3C;
        arg0 -= 30720;
    } else {
        phi_v1 = 511;
        phi_a1 = 9;
        array = D_80085EC0;
    }

    index = arg0 >> phi_a1;
    tmp1 = array[index];
    tmp2 = array[index+1];

    return tmp1 - (((tmp1 - tmp2) * (arg0 & phi_v1)) >> phi_a1);
}

u16 func_15048664(s16 arg0) {
    s32 tmp;

    if (arg0 >= 0) {
       tmp = arg0;
    } else {
       tmp = -arg0;
    }

    tmp = func_150485E0(tmp);
    if (arg0 < 0) {
        tmp = 0xFFFF - tmp;
    }
    return tmp;
}

s16 func_150486B8(s16 arg0) {
    s32 tmp;

    if (arg0 >= 0) {
        tmp = arg0;
    } else {
        tmp = -arg0;
    }

    tmp = func_150485E0(tmp);
    if (arg0 >= 0) {
        tmp = 0x7FFF - tmp;
    } else {
        tmp = tmp - 0x8000;
    }
    return tmp;
}
